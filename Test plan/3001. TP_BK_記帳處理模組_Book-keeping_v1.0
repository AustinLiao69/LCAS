TP_BK_記帳處理模組_Book-keeping_v1.0

1. 測試範圍
數據格式驗證（日期、金額、大項代碼、子項代碼）
記帳數據寫入 Google Sheets（檢查儲存結果是否正確）
錯誤處理（錯誤輸入時，能否阻擋或回報異常）

2. 測試案例（Test Cases）
2.1 記帳數據驗證
正常輸入：
日期：2025/03/30，金額：500，大項代碼：103，子項代碼：10302
預期結果：成功寫入 Google Sheets
日期格式錯誤：
日期：2025/03/aa
預期結果：拒絕寫入，回報「日期格式錯誤」
金額為負數：
金額：-100
預期結果：拒絕寫入，回報「金額不能為負數」
缺少大項代碼：
大項代碼：空白
預期結果：拒絕寫入，回報「缺少大項代碼」
缺少子項代碼：
子項代碼：空白
預期結果：拒絕寫入，回報「缺少子項代碼」
記帳 ID 自動生成：
輸入完整記帳資訊，但不填收支 ID
預期結果：自動生成格式 YYYYMMDD-00001

2.2 記帳數據存儲
確認寫入位置：
輸入記帳資料
預期結果：資料寫入 01. 總帳 指定範圍
確認數據完整性：
檢查 Google Sheets 記錄
預期結果：所有欄位資料皆正確填寫

2.3 錯誤處理
Google Sheets 連線失敗：
斷開網路
預期結果：回報「Google Sheets 無法存取」
重複收支 ID：
20250330-00001 已存在
預期結果：提示「記錄已存在，是否覆蓋？」

3. 測試方法
Google Sheets 測試：
準備測試表單，手動輸入測試數據，觀察是否正常寫入
Google Apps Script 測試：
撰寫測試函數，透過 Logger.log() 確認數據處理狀況
模擬錯誤輸入，檢查 BK 是否正確回報錯誤

4. 測試步驟
開啟 Google Sheets，設定測試工作表
執行 Google Apps Script 測試函數
輸入不同測試數據，觀察寫入結果
測試錯誤處理，確認回報是否正確
記錄測試結果，修正邏輯問題
