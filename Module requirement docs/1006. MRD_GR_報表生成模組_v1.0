MRD_GR_報表生成模組_v1.1

1.0 模組概述（Module Overview）

報表生成模組（GR，Generate Report Module）主要負責從 Google Sheet 讀取數據，並依據請求生成不同類型的報表，如日報、週報、月報等。此模組不進行數據合併或財務分析，僅提供原始報表數據。

2.0 功能需求（Functional Requirements）

2.1 報表數據提取

從 Google Sheet 讀取原始數據，並根據請求的時間範圍過濾數據。


2.2 多類型報表支持

支援日報、週報、月報、年度報表等不同範圍的報表生成。

週報與月報的時間範圍由 MR 計算，GR 依照 MR 指定的範圍提供數據。


2.3 報表輸出格式

以 JSON 格式返回數據，供 MR 進行合併與分析。

若未來有需求，可擴展為 Excel、PDF 格式輸出。


2.4 錯誤處理機制

若查無數據，返回適當的錯誤訊息。

當 Google Sheet 連線失敗時，啟動重試機制。


3.0 輸入/輸出規格（Input & Output Specifications）

3.1 輸入

時間範圍（由 MR 指定，如「2025 年 3 月」或「2025 年第 12 週」）。

科目範圍（如「所有收入類科目」或「僅限 103 餐飲費」）。


3.2 輸出

原始報表數據（JSON 格式）。

若查無數據，返回「No Data Found」錯誤訊息。


4.0 錯誤處理與例外狀況（Error Handling & Edge Cases）

無數據：返回錯誤訊息，避免產出空報表。

時間範圍錯誤：若 MR 傳入非法時間範圍（如 2025 年 13 月），則返回錯誤。

Google Sheet 連線問題：提供錯誤日誌，並啟動重試機制。


5.0 測試計畫（Test Plan）

5.1 單元測試

測試不同時間範圍的報表是否能正確生成。

測試數據過濾機制是否符合需求（如僅查詢某些科目）。


5.2 整合測試

測試 GR 是否能與 MR 正確交互，確保時間範圍傳遞無誤。


5.3 使用者測試

確保報表格式正確，並滿足使用者需求。
