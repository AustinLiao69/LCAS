MRD_AM_帳號管理模組_v1.2

1.0 模組概述（Module Overview） 帳號管理模組的主要用途是管理系統中的使用者帳號，包括新增帳號、註銷帳號等操作。 此模組負責帳號的創建、管理和刪除，確保帳號數據的安全性和完整性。由於本系統使用 LINE 官方帳號 進行登入，帳號驗證透過 LINE Login OAuth 進行，不需儲存或管理密碼。

2.0 功能需求（Functional Requirements） 
2.1 新增帳號
支持新增使用者帳號，包含 LINE 使用者 ID（userId）、角色等信息。
帳號種類分成: M: Merged ledger admin S: Single ledger J: Join other ledger
當新增帳號時，自動在 Google Sheet 中創建對應的帳本。

2.2 註銷帳號
支持註銷使用者帳號，確保帳號數據被安全刪除。

2.3 帳號修改
支持修改使用者帳號信息，如角色等。
支持 更新 LINE 綁定資訊（如名稱等）。

2.4 帳號查詢
支持查詢使用者帳號信息，提供帳號管理的便捷性。

2.5 錯誤處理與重試機制
當帳號操作失敗時，記錄錯誤並啟動重試機制，以確保帳號操作的成功。


3.0 輸入/輸出規格（Input & Output Specifications） 
3.1 輸入
LINE 使用者 ID（userId）。
角色資訊（M、S、J）。


3.2 輸出

操作結果：帳號新增、註銷、修改等操作的結果。
錯誤日誌：記錄帳號操作過程中的錯誤信息。
Google Sheet 帳本創建結果。

4.0 錯誤處理與例外狀況（Error Handling & Edge Cases）
LINE 授權失敗：若 LINE OAuth 授權失敗，記錄錯誤並提示用戶重新授權。

OAuth Token 過期：當存取權杖過期時，請求使用者重新登入。

操作失敗：當帳號操作失敗時，記錄錯誤並啟動重試機制，確保操作最終能被成功執行。

權限不足：當使用者權限不足時，記錄錯誤並拒絕操作。

Google Sheet 帳本創建失敗：若 Google Sheet 無法正常創建帳本，記錄錯誤並通知管理員。


5.0 測試計畫（Test Plan） 5.1 單元測試

測試各個功能模組，如新增帳號、註銷帳號、帳號修改等，確保其正常運行。

測試 Google Sheet 帳本創建功能，確保帳本能正確生成。


5.2 整合測試
測試帳號管理模組與 LINE OAuth 的整合，確保身份驗證流程正常。
測試帳號管理模組與其他 LCAS 模組的整合，確保數據流轉正確。
測試與 Google Sheet 的整合，確保帳本能夠正確寫入。

5.3 使用者測試
邀請使用者進行測試，收集反饋意見，並進行相應的改進。

5.4 邊界測試
測試各種邊界條件，如 LINE 授權失敗、OAuth 過期等，確保系統在這些情況下的穩定性。
測試 Google Sheet API 失敗情境，確保錯誤處理機制生效。

